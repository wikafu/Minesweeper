<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Minesweeper</title>
    <meta property="og:image" content="https://YOUR-APP.vercel.app/og.png">

    <!-- share previews -->
    <meta property="og:title" content="Minesweeper" />
    <meta property="og:description" content="Tap tiles, avoid bombs" />
    <meta property="og:image" content="https://your-domain.xyz/og.png" />
    <meta name="theme-color" content="#000000" />

    <link rel="icon" href="" />
    <link rel="stylesheet" href="style.css" />

    
    <!-- your game code -->
    <script src="script.js" defer></script>

<!-- farcaster mini app sdk via esm cdn -->
<script type="module">
  import { sdk } from "https://esm.sh/@farcaster/miniapp-sdk"

  // ğŸ‘‰ add this line so script.js can see it
  window.sdk = sdk

  // tell farcaster your app is ready once the page is painted
  window.addEventListener("load", async () => {
    try {
      await sdk.actions.ready()
      await sdk.actions.addMiniApp()
    } catch {}
  })

  // make the board perfectly fit the visible frame
  function fitBoard() {
    const frame = document.getElementById('game-frame');
    if (!frame) return;

    const availW = frame.clientWidth - 24;
    const availH = frame.clientHeight - 180;

    const size = Math.max(240, Math.min(availW, availH));
    const cell = Math.floor(size / 8);

    document.documentElement.style.setProperty('--board', `${cell * 8}px`);
    document.documentElement.style.setProperty('--cell', `${cell}px`);
  }

  fitBoard();
  window.addEventListener('resize', fitBoard);
  window.addEventListener('orientationchange', fitBoard);
  document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'visible') fitBoard();
  });

  // block scroll bounce
  document.addEventListener("touchmove", (e) => { e.preventDefault() }, { passive: false })
</script>
  </head>

  <body>
<main id="game-frame">

    <!-- subtle drifting particles overlay -->
  <div id="theme-particles"></div>

  <!-- home screen -->
<div id="home-screen">
  <!-- top row: FID on left, Daily on right -->
  <div class="home-top-row">
    <div id="player-fid">guest</div>
<button id="daily-button">
  <span id="daily-label">Daily Challenge</span>
  <span id="daily-charge-bar"></span>
</button>
  </div>

  <!-- daily text in the top-middle -->
  <div id="home-daily-summary">
  <div id="daily-best" class="daily-best-banner">
      No one cleared today. Be the first. ğŸ‘€
    </div>
    <div id="daily-your">
      Your best today: --:--
    </div>
  </div>

  <!-- big centered title -->
  <h1 id="home-title">MINESWEEPER</h1>

  <!-- buttons under the title -->
<button id="level-button">Level: easy</button>
<div id="level-tagline" class="level-tagline">
  Warm-up board. Breathe.
</div>
<button id="start-button">Start</button>
<button id="connect-wallet">Connect Wallet</button>
<span id="wallet-address" style="display:none; font-size:13px; opacity:0.8;"></span>

<div id="home-bottom-buttons">
  <button id="music-toggle" class="round-icon-btn">ğŸµ</button>
  <button id="instructions-button" class="round-icon-btn">â”</button>
  <button id="theme-button" class="round-icon-btn">ğŸ¨</button>
</div>
</div>


  <!-- game screen -->
<div id="game-screen" style='display:none; width:100%; height:100%;'>

<div id="game-hud" class="hud-normal">
  <div class="hud-top-row">
    LEVEL: <span id="level-label">easy</span>
  </div>

  <div class="hud-bottom-row">
    <div class="hud-stat">
      <span class="hud-icon">ğŸ’£</span>
      <span id="mines-count">0</span>
    </div>
    <div class="hud-stat">
      <span class="hud-icon">â±</span>
      <span id="timer">00:00</span>
    </div>
    <div class="hud-stat">
      <span class="hud-icon">ğŸ†</span>
      <span id="best">--:--</span>
    </div>
  </div>
</div>


    <!-- tiny daily progress bar (only used in Daily mode) -->
    <div id="daily-progress-wrap">
      <div id="daily-progress-label">Daily Progress: 0%</div>
      <div class="daily-progress-bar">
        <div class="daily-progress-bar-fill" id="daily-progress-bar"></div>
      </div>
    </div>
    
    <div id="board"></div>

   <div style="display:flex; gap:12px; justify-content:center; margin-top:-10px;">
      <button id="flag-button" aria-label="toggle flag" style="width:96px; height:44px; font-size:26px;">ğŸš©</button>
      <button id="hint" style="width:75px; height:44px; font-size:20px;">ğŸ’¡3</button>
      <button id="share" style="width:52px; height:44px; font-size:22px;">ğŸ“¤</button>
      <button id="mute" style="width:52px; height:44px; font-size:22px;">ğŸ”Š</button>
    </div>
  </div>

<!-- game over popup -->
<div id="gameover-overlay">
  <div class="go-backdrop"></div>
  <div class="go-card">
    <h2 id="go-title">Cleared</h2>
    <p id="go-sub">
      Time: <span id="go-time">00:00</span>
    </p>

    <!-- new share button -->
    <button id="go-share">Share</button>

    <div class="go-buttons">
      <button id="go-home">Home</button>
      <button id="go-replay">Replay</button>
    </div>
  </div>
</div>


<!-- instructions popup -->
<div id="instructions-overlay">
  <div class="instr-backdrop"></div>
  <div class="instr-card">
    <h2>How to play</h2>
    <p>
      Tap tiles to reveal the board.  
      Numbers show how many mines touch that tile.  
      Use the flag button to mark suspected mines and clear all safe tiles to win.
    </p>

    <p>
      You can practice on three levels - easy, medium, and hard.  
      Change the level on the home screen then hit Start to play a normal run.
    </p>

    <h3>Daily challenge</h3>
    <p>
      Daily Challenge gives one shared board per day for everyone.  
      The level is picked automatically for the day and the layout is the same for all players.
    </p>
    <p>
      You get one real attempt per day - if you lose or win, the button locks until the next reset.  
      The gold banner on the home shows the fastest clear today with the players Farcaster handle.
    </p>

    <h3>Tips</h3>
    <ul>
      <li>ğŸ’¡ Use hints to reveal a random safe tile when you are stuck.</li>
      <li>ğŸš© Place flags on tiles you are sure are mines so you do not tap them by mistake.</li>
      <li>â± Faster clears help you climb the daily best times.</li>
      <li>ğŸµ Use the volume and music buttons to control sound.</li>
      <li>ğŸ¨ Switch themes to change the look and background music.</li>
      <li>ğŸ“¤ Share your clears directly to Farcaster from the in game share button.</li>
    </ul>

    <button id="instr-close">Got it</button>
  </div>
</div>

</main>

  </body>
</html>
